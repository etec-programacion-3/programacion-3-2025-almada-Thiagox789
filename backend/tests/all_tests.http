@host = http://127.0.0.1:8000
@email = test23232@example.com
@password = pass12345
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0MjMyMzJAZXhhbXBsZS5jb20iLCJleHAiOjE3NjI4Mjc2Mzh9.7J2BVx19WZWH4Lx58vLLZ_fYzMiYhb9hSE1dkUHuItg

###
# Registrar nuevo usuario
POST {{host}}/auth/register
Content-Type: application/json

{
  "email_usuario": "{{email}}",
  "nombre_usuario": "TestHTTP",
  "apellido_usuario": "User",
  "password": "{{password}}"
}

###

# Iniciar sesión (obtener token)
# @name loginUser
POST {{host}}/auth/login
Content-Type: application/json

{
  "email_usuario": "{{email}}",
  "password": "{{password}}"
}

###

@token = {{loginUser.response.body.access_token}}

# Acceder a una ruta protegida
GET {{host}}/auth/protected
Authorization: Bearer {{token}}
Content-Type: application/json

###

# Crear producto (requiere autenticación)
# @name createProduct
POST {{host}}/products/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nombre_producto": "HTTP Test Product",
  "descripcion_producto": "Producto creado desde test.http",
  "cantidad_producto": 5,
  "precio_producto": 19.9,
  "image_url": "https://picsum.photos/200"
}

###

@product_id = {{createProduct.response.body.id_producto}}

# Listar productos
GET {{host}}/products/
Content-Type: application/json

###

# Obtener producto específico
GET {{host}}/products/{{product_id}}
Content-Type: application/json

###

# Actualizar producto
PUT {{host}}/products/{{product_id}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nombre_producto": "Producto actualizado desde HTTP",
  "descripcion_producto": "Nueva descripción",
  "precio_producto": 29.99
}

###

# Actualizar stock del producto
PUT {{host}}/products/{{product_id}}/stock
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "quantity": 2
}

###

# Crear compra (checkout)
# @name createPurchase
POST {{host}}/purchases/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "items": [
    { "producto_id": {{product_id}}, "cantidad": 1 }
  ]
}

###

# Obtener mis compras
GET {{host}}/purchases/me
Authorization: Bearer {{token}}
Content-Type: application/json

###

# Eliminar producto
DELETE {{host}}/products/{{product_id}}
Authorization: Bearer {{token}}
Content-Type: application/json
